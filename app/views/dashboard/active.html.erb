<div class="row">
  <%= render :partial => 'shared/dashboard_sidebar' %>
  
  <main class="col-md-9 ms-sm-auto col-lg-10 px-md-4">
    <div class="d-flex justify-content-between flex-wrap flex-md-nowrap align-items-center pt-3 pb-2 mb-3 border-bottom">
      <h1 class="h4">Active Pushes</h1>
      <div class="btn-toolbar mb-2 mb-md-0">
        <div class="btn-group me-2">
          <button type="button" class="btn btn-sm btn-outline-secondary">Share</button>
          <button type="button" class="btn btn-sm btn-outline-secondary">Export</button>
        </div>
        <button type="button" class="btn btn-sm btn-outline-secondary dropdown-toggle">
          <span data-feather="calendar"></span>
          This week
        </button>
      </div>
    </div>

    <div class="table-responsive">
    <table class="table table-striped table-hover" aria-label='Active Pushes'>
      <thead>
      <tr>
          <th scope="col">Secret URL Token</th>
          <th scope="col">Created On</th>
          <th scope="col">Views</th>
          <th scope="col">Days</th>
          <th scope="col"><em class='bi-tools'></em></th>
      </tr>
      </thead>
      <tbody>
      <% for payload in @active_payloads do %>
        <tr>
          <td><%= payload.url_token %></td>
          <td><%= payload.created_at.to_s(:db) %> UTC</td>
          <td><%= "#{payload.views.count}/#{payload.expire_after_views}"%></td>
          <td><%= "#{payload.days_old}/#{payload.expire_after_days}"%></td>
          <td>
            <%= link_to audit_password_path(payload), class: 'btn btn-secondary btn-sm', rel: 'nofollow', disable_with: 'Processing...' do %>
              <em class='bi-card-list'></em> Details & Audit Log
            <% end %>

          </td>
        </tr>
      <% end %>
      </tbody>
    </table>
    </div>
      
    <% if @active_payloads.empty? %>
      <p class='text-center mt-3'>
        You currently have no active pushes.
      </p>
      <p class='text-center'>
        <%= link_to 'Push Something Now', root_path, class: 'btn btn-primary' %>
      </p>
    <% end %>
  </main>
</div>
